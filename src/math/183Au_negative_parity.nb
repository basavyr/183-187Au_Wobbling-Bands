(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28776,        828]
NotebookOptionsPosition[     26731,        782]
NotebookOutlinePosition[     27071,        797]
CellTagsIndexPosition[     27028,        794]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "183"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a4d9b798-1f05-4c06-a927-d23f8f063415"],
 "Au Fitting the negative parity bands"
}], "Section",
 CellChangeTimes->{{3.832640576018395*^9, 
  3.832640600330542*^9}},ExpressionUUID->"f98d335f-170a-49fb-ba8c-\
5343c46189f8"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global*`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8326407070622473`*^9, 3.832640713664591*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"12fa8c7c-77e1-4035-b680-05f6e95b738c"],

Cell[CellGroupData[{

Cell["Analytical formulae", "Subsection",
 CellChangeTimes->{{3.832640608418985*^9, 
  3.8326406118275547`*^9}},ExpressionUUID->"5e9e9395-271e-44ce-9f07-\
42623431878b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"I0", "=", "4.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j", "=", "4.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IF", "[", "MOI_", "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", "MOI"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RAD", "[", "angle_", "]"}], ":=", 
   RowBox[{"angle", "*", 
    FractionBox["\[Pi]", "180"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HMin", "[", 
    RowBox[{
    "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", 
     "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A2", "+", "A3"}], ")"}], 
     FractionBox[
      RowBox[{"I", "+", "j"}], "2"]}], "+", 
    RowBox[{"A1", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"I", "-", "j"}], ")"}], "2"]}], "-", 
    RowBox[{"V", "*", 
     FractionBox[
      RowBox[{
       RowBox[{"2", "j"}], "-", "1"}], 
      RowBox[{"j", "+", "1"}]], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Gamma]", "+", 
       FractionBox["\[Pi]", "6"]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B1", "[", 
    RowBox[{
    "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", 
     "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "1"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "I"}], "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"A3", "-", "A1"}], ")"}]}], "+", 
         RowBox[{"2", "j", "*", "A1"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "I"}], "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"A2", "-", "A1"}], ")"}]}], "+", 
         RowBox[{"2", "j", "*", "A1"}]}], ")"}]}], "+", 
      RowBox[{"8", "*", "A2", "*", "A3", "*", "I", "*", "j"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "j"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"A3", "-", "A1"}], ")"}]}], "+", 
         RowBox[{"2", "I", "*", "A1"}], "+", 
         RowBox[{"V", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"2", "j"}], "-", "1"}], 
           RowBox[{"j", 
            RowBox[{"(", 
             RowBox[{"j", "+", "1"}], ")"}]}]], 
          RowBox[{"Sqrt", "[", "3", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], 
             RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
            RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ")"}]}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "j"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"A2", "-", "A1"}], ")"}]}], "+", 
         RowBox[{"2", "I", "*", "A1"}], "+", 
         RowBox[{"V", "*", 
          FractionBox[
           RowBox[{
            RowBox[{"2", "j"}], "-", "1"}], 
           RowBox[{"j", 
            RowBox[{"(", 
             RowBox[{"j", "+", "1"}], ")"}]}]], "2", 
          RowBox[{"Sqrt", "[", "3", "]"}], 
          RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C1", "[", 
    RowBox[{
    "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", 
     "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "I"}], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"A3", "-", "A1"}], ")"}]}], "+", 
          RowBox[{"2", "j", "*", "A1"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "j"}], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"A3", "-", "A1"}], ")"}]}], "+", 
          RowBox[{"2", "I", "*", "A1"}], "+", 
          RowBox[{"V", "*", 
           FractionBox[
            RowBox[{
             RowBox[{"2", "j"}], "-", "1"}], 
            RowBox[{"j", 
             RowBox[{"(", 
              RowBox[{"j", "+", "1"}], ")"}]}]], 
           RowBox[{"Sqrt", "[", "3", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], 
              RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "+", 
             RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"4", "I", "*", "j", "*", 
        SuperscriptBox["A3", "2"]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "I"}], "-", "1"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"A2", "-", "A1"}], ")"}]}], "+", 
          RowBox[{"2", "j", "*", "A1"}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "j"}], "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"A2", "-", "A1"}], ")"}]}], "+", 
          RowBox[{"2", "I", "*", "A1"}], "+", 
          RowBox[{"V", "*", 
           FractionBox[
            RowBox[{
             RowBox[{"2", "j"}], "-", "1"}], 
            RowBox[{"j", 
             RowBox[{"(", 
              RowBox[{"j", "+", "1"}], ")"}]}]], "2", 
           RowBox[{"Sqrt", "[", "3", "]"}], 
           RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"4", "I", "*", "j", "*", 
        SuperscriptBox["A2", "2"]}]}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Omega1", "[", 
    RowBox[{
    "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", 
     "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"B1", "[", 
         RowBox[{
         "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
          "\[Gamma]"}], "]"}]}], "-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"B1", "[", 
           RowBox[{
           "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
            "\[Gamma]"}], "]"}], "2"], "-", 
         RowBox[{"4", "*", 
          RowBox[{"C1", "[", 
           RowBox[{
           "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
            "\[Gamma]"}], "]"}]}]}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Omega2", "[", 
    RowBox[{
    "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", "A3_", ",", "V_", ",", 
     "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"B1", "[", 
         RowBox[{
         "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
          "\[Gamma]"}], "]"}]}], "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"B1", "[", 
           RowBox[{
           "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
            "\[Gamma]"}], "]"}], "2"], "-", 
         RowBox[{"4", "*", 
          RowBox[{"C1", "[", 
           RowBox[{
           "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
            "\[Gamma]"}], "]"}]}]}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Energy", "[", 
    RowBox[{
    "nw1_", ",", "nw2_", ",", "I_", ",", "j_", ",", "A1_", ",", "A2_", ",", 
     "A3_", ",", "V_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"HMin", "[", 
     RowBox[{
     "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
      "\[Gamma]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"Omega1", "[", 
      RowBox[{
      "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
       "\[Gamma]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"nw1", "+", 
       FractionBox["1", "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Omega2", "[", 
      RowBox[{
      "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",", "V", ",", 
       "\[Gamma]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"nw2", "+", 
       FractionBox["1", "2"]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExcEn", "[", 
    RowBox[{
    "nw1_", ",", "nw2_", ",", "I_", ",", "A1_", ",", "A2_", ",", "A3_", ",", 
     "V_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Energy", "[", 
     RowBox[{
     "nw1", ",", "nw2", ",", "I", ",", "j", ",", "A1", ",", "A2", ",", "A3", 
      ",", "V", ",", "\[Gamma]"}], "]"}], "-", 
    RowBox[{"Energy", "[", 
     RowBox[{
     "0", ",", "0", ",", "I0", ",", "j", ",", "A1", ",", "A2", ",", "A3", ",",
       "V", ",", "\[Gamma]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"band1Negative", "[", 
    RowBox[{
    "I_", ",", "I1_", ",", "I2_", ",", "I3_", ",", "V_", ",", "\[Gamma]_"}], 
    "]"}], ":=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"ExcEn", "[", 
      RowBox[{"0", ",", "0", ",", "I", ",", 
       RowBox[{"IF", "[", "I1", "]"}], ",", 
       RowBox[{"IF", "[", "I2", "]"}], ",", 
       RowBox[{"IF", "[", "I3", "]"}], ",", "V", ",", 
       RowBox[{"RAD", "[", "\[Gamma]", "]"}]}], "]"}], ",", "4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"band2Negative", "[", 
    RowBox[{
    "I_", ",", "I1_", ",", "I2_", ",", "I3_", ",", "V_", ",", "\[Gamma]_"}], 
    "]"}], ":=", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"ExcEn", "[", 
      RowBox[{"1", ",", "0", ",", "I", ",", 
       RowBox[{"IF", "[", "I1", "]"}], ",", 
       RowBox[{"IF", "[", "I2", "]"}], ",", 
       RowBox[{"IF", "[", "I3", "]"}], ",", "V", ",", 
       RowBox[{"RAD", "[", "\[Gamma]", "]"}]}], "]"}], ",", "4"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.832640532293206*^9, 3.832640532543971*^9}, {
  3.832640620752014*^9, 3.832640621662516*^9}, {3.832641149495529*^9, 
  3.832641164719571*^9}, {3.8326411984345617`*^9, 3.83264123601912*^9}, {
  3.832641808584043*^9, 3.832641821061054*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"14af30ab-b022-49ac-8489-e9da399b5f4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Experimental data", "Subsection",
 CellChangeTimes->{{3.832640626765214*^9, 
  3.832640631516452*^9}},ExpressionUUID->"1a385d22-acd8-49a8-9a8b-\
80ed5ea6695a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1Negative", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"9", "/", "2"}], ",", 
       RowBox[{"53", "/", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2Negative", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"19", "/", "2"}], ",", 
       RowBox[{"51", "/", "2"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yrastNegative", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "12.78", ",", "232", ",", "566", ",", "990", ",", "1492", ",", "2063", 
       ",", "2690", ",", "3358", ",", "4050", ",", "4760", ",", "5497", ",", 
       "6242"}], "}"}], "/", "1000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tw1Negative", "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1056", ",", "1488", ",", "1987", ",", "2540", ",", "3148", ",", "3796",
        ",", "4457", ",", "5133", ",", "5912"}], "}"}], "/", "1000"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e0Negative", "=", 
   RowBox[{"yrastNegative", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yrastNegative", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yrastNegative", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "e0Negative"}], ")"}], ",", 
       "4"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "yrastNegative", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tw1Negative", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"tw1Negative", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "e0Negative"}], ")"}], ",", 
       "4"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "tw1Negative", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "yrastNegative", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "tw1Negative", "]"}]}], "Input",
 CellChangeTimes->{{3.832641304818912*^9, 3.832641333006418*^9}, {
  3.83264174322014*^9, 3.832641775666514*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"d7b5e66e-05a3-47c8-9484-4a1d356b1216"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.219220000000000026`4.", ",", "0.553219999999999934`4.", ",", 
   "0.9772199999999999775`4.", ",", "1.4792199999999999793`4.", ",", 
   "2.0502200000000003755`4.", ",", "2.6772200000000001552`4.", ",", 
   "3.3452200000000003044`4.", ",", "4.0372199999999995867`4.", ",", 
   "4.7472199999999995512`4.", ",", "5.4842199999999996507`4.", ",", 
   "6.2292199999999997573`4."}], "}"}]], "Print",
 CellChangeTimes->{
  3.832641644427436*^9, {3.8326417535800743`*^9, 3.832641776156556*^9}, 
   3.832641825805275*^9},
 CellLabel->
  "During evaluation of \
In[196]:=",ExpressionUUID->"3b292ec0-b647-44f4-a06c-05b589423314"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0432200000000000362`4.", ",", "1.4752199999999999758`4.", ",", 
   "1.9742200000000000859`4.", ",", "2.527220000000000244`4.", ",", 
   "3.1352200000000003399`4.", ",", "3.7832200000000000273`4.", ",", 
   "4.4442199999999996152`4.", ",", "5.1202199999999997715`4.", ",", 
   "5.8992199999999996862`4."}], "}"}]], "Print",
 CellChangeTimes->{
  3.832641644427436*^9, {3.8326417535800743`*^9, 3.832641776156556*^9}, 
   3.832641825806611*^9},
 CellLabel->
  "During evaluation of \
In[196]:=",ExpressionUUID->"496f4b4f-0bd1-477a-a4ca-24c342cbfae3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting procedure", "Subsection",
 CellChangeTimes->{{3.8326406341341867`*^9, 
  3.832640637534284*^9}},ExpressionUUID->"a24e9419-a6b7-4467-a7b3-\
dabfc0b9c438"],

Cell[CellGroupData[{

Cell["Bounds", "Subsubsection",
 CellChangeTimes->{{3.832641025438862*^9, 
  3.8326410262489157`*^9}},ExpressionUUID->"7e27f166-46a2-4eb4-aaaf-\
83f032413837"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i1bounds", "=", 
   RowBox[{"{", 
    RowBox[{"70", ",", "80"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i2bounds", "=", 
   RowBox[{"{", 
    RowBox[{"10", ",", "40"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i3bounds", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "20"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vbounds", "=", 
   RowBox[{"{", 
    RowBox[{"0.01", ",", "9.99"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gmbounds", "=", 
   RowBox[{"{", 
    RowBox[{"18.9", ",", "24.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramSetNegative", "=", 
   RowBox[{"{", 
    RowBox[{
    "73.209", ",", "19.805", ",", "3.752", ",", "0.243", ",", "20.013"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.832641633905386*^9, 3.8326416371314287`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"7cc44708-0af3-4209-90d9-d4532d99f49a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"band1Negative", "[", 
    RowBox[{
     RowBox[{"s1Negative", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "73.209", ",", "19.805", ",", 
     "3.752", ",", "0.243", ",", "20.013"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "s1Negative", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"band2Negative", "[", 
    RowBox[{
     RowBox[{"s2Negative", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "73.209", ",", "19.805", ",", 
     "3.752", ",", "0.243", ",", "20.013"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "s2Negative", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.832641650668086*^9, 3.832641711869529*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"20c3585e-56da-4988-81d5-7400986970db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.3069683939724543453`4.", ",", "0.661605591994060438`4.", ",", 
   "1.0696101738702685768`4.", ",", "1.5315955746732463627`4.", ",", 
   "2.0477984716853816494`4.", ",", "2.6183431868805859821`4.", ",", 
   "3.2433058504576832703`4.", ",", "3.9227372569773724109`4.", ",", 
   "4.6566731638077225597`4.", ",", "5.4451396934946432182`4.", ",", 
   "6.2881564666863685176`4."}], "}"}]], "Output",
 CellChangeTimes->{{3.832641686067844*^9, 3.832641712974083*^9}, 
   3.8326418258710957`*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"531b624a-54e4-4d7c-9919-5042b248f227"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9190761493472148214`4.", ",", "1.3754054753988127491`4.", ",", 
   "1.8868283108924031044`4.", ",", "2.4533158425441117245`4.", ",", 
   "3.0748004883909931806`4.", ",", "3.7512191910933978534`4.", ",", 
   "4.4825202125162117994`4.", ",", "5.2686623565382353362`4.", ",", 
   "6.1096129188620000861`4."}], "}"}]], "Output",
 CellChangeTimes->{{3.832641686067844*^9, 3.832641712974083*^9}, 
   3.8326418258973827`*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"e267ffc4-5e9e-43fd-9353-561ad363acef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Minimization function", "Subsubsection",
 CellChangeTimes->{{3.8326410324911737`*^9, 
  3.832641040639915*^9}},ExpressionUUID->"361855eb-3a51-4ec0-9c70-\
874ac65f8893"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chi2FuncNegative", "[", 
     RowBox[{"I1_", ",", "I2_", ",", "I3_", ",", "V_", ",", "\[Gamma]_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "s1Negative", "]"}], "+", 
             RowBox[{"Length", "[", "s2Negative", "]"}], "+", "1"}], ")"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"yrastNegative", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"band1Negative", "[", 
                  RowBox[{
                   RowBox[{"s1Negative", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "I1", ",", "I2", ",",
                    "I3", ",", "V", ",", "\[Gamma]"}], "]"}]}], ")"}], "2"], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "s1Negative", "]"}]}], "}"}]}], "]"}], 
            "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tw1Negative", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"band2Negative", "[", 
                  RowBox[{
                   RowBox[{"s2Negative", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "I1", ",", "I2", ",",
                    "I3", ",", "V", ",", "\[Gamma]"}], "]"}]}], ")"}], "2"], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "s2Negative", "]"}]}], "}"}]}], 
             "]"}]}], ")"}]}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "s1Negative", "]"}], "+", 
           RowBox[{"Length", "[", "s2Negative", "]"}], "+", "1"}], ")"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"yrastNegative", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"band1Negative", "[", 
                RowBox[{
                 RowBox[{"s1Negative", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "I1", ",", "I2", ",", 
                 "I3", ",", "V", ",", "\[Gamma]"}], "]"}]}], ")"}], "2"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "s1Negative", "]"}]}], "}"}]}], "]"}], 
          "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tw1Negative", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"band2Negative", "[", 
                RowBox[{
                 RowBox[{"s2Negative", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "I1", ",", "I2", ",", 
                 "I3", ",", "V", ",", "\[Gamma]"}], "]"}]}], ")"}], "2"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "s2Negative", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], "]"}], ",", 
      SuperscriptBox["10", "9"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parameter", " ", "set", " ", "for", " ", "the", " ", "negative", " ", 
    "bands", " ", "from", " ", "Python"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"paramSetNegative", "=", 
     RowBox[{"{", 
      RowBox[{
      "73.209", ",", "19.805", ",", "3.752", ",", "0.243", ",", "20.013"}], 
      "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"minChi2Negative", "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"chi2FuncNegative", "[", 
          RowBox[{"I1", ",", "I2", ",", "I3", ",", "V", ",", "\[Gamma]"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"i1bounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "I1", 
           "\[LessEqual]", 
           RowBox[{"i1bounds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"i2bounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "I2", 
           "\[LessEqual]", 
           RowBox[{"i2bounds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"i3bounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "I3", 
           "\[LessEqual]", 
           RowBox[{"i3bounds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"vbounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "V", 
           "\[LessEqual]", 
           RowBox[{"vbounds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"gmbounds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Gamma]", 
           "\[LessEqual]", 
           RowBox[{"gmbounds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"I1", ",", "I2", ",", "I3", ",", "V", ",", "\[Gamma]"}], 
        "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"paramSetNegative", "=", 
     RowBox[{"Values", "@", 
      RowBox[{"minChi2Negative", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rmsValueNegative", "=", 
     RowBox[{"minChi2Negative", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<RMS-> \>\"", ",", "rmsValueNegative", ",", "\"\<\\nP -> \>\"", ",", 
      "paramSetNegative"}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.832640645319111*^9, 3.832640700186737*^9}, {
   3.8326409053344927`*^9, 3.832641110816834*^9}, 3.8326416008061132`*^9},
 CellLabel->
  "In[213]:=",ExpressionUUID->"e517a049-1d3c-4a7a-b0c4-a7c63cced655"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1175, 911},
WindowMargins->{{Automatic, 380}, {Automatic, 216}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 363, 10, 68, "Section",ExpressionUUID->"f98d335f-170a-49fb-ba8c-5343c46189f8"],
Cell[946, 34, 227, 4, 30, "Input",ExpressionUUID->"12fa8c7c-77e1-4035-b680-05f6e95b738c"],
Cell[CellGroupData[{
Cell[1198, 42, 169, 3, 54, "Subsection",ExpressionUUID->"5e9e9395-271e-44ce-9f07-42623431878b"],
Cell[1370, 47, 10819, 326, 604, "Input",ExpressionUUID->"14af30ab-b022-49ac-8489-e9da399b5f4f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12226, 378, 165, 3, 54, "Subsection",ExpressionUUID->"1a385d22-acd8-49a8-9a8b-80ed5ea6695a"],
Cell[CellGroupData[{
Cell[12416, 385, 2679, 79, 199, "Input",ExpressionUUID->"d7b5e66e-05a3-47c8-9484-4a1d356b1216"],
Cell[CellGroupData[{
Cell[15120, 468, 671, 14, 24, "Print",ExpressionUUID->"3b292ec0-b647-44f4-a06c-05b589423314"],
Cell[15794, 484, 592, 13, 24, "Print",ExpressionUUID->"496f4b4f-0bd1-477a-a4ca-24c342cbfae3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16447, 504, 167, 3, 54, "Subsection",ExpressionUUID->"a24e9419-a6b7-4467-a7b3-dabfc0b9c438"],
Cell[CellGroupData[{
Cell[16639, 511, 159, 3, 45, "Subsubsection",ExpressionUUID->"7e27f166-46a2-4eb4-aaaf-83f032413837"],
Cell[16801, 516, 983, 29, 136, "Input",ExpressionUUID->"7cc44708-0af3-4209-90d9-d4532d99f49a"],
Cell[CellGroupData[{
Cell[17809, 549, 929, 24, 52, "Input",ExpressionUUID->"20c3585e-56da-4988-81d5-7400986970db"],
Cell[18741, 575, 625, 12, 34, "Output",ExpressionUUID->"531b624a-54e4-4d7c-9919-5042b248f227"],
Cell[19369, 589, 546, 11, 34, "Output",ExpressionUUID->"e267ffc4-5e9e-43fd-9353-561ad363acef"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19964, 606, 174, 3, 45, "Subsubsection",ExpressionUUID->"361855eb-3a51-4ec0-9c70-874ac65f8893"],
Cell[20141, 611, 6550, 166, 449, "Input",ExpressionUUID->"e517a049-1d3c-4a7a-b0c4-a7c63cced655"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

