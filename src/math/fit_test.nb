(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14178,        362]
NotebookOptionsPosition[     12751,        332]
NotebookOutlinePosition[     13091,        347]
CellTagsIndexPosition[     13048,        344]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.832030838629945*^9, 3.832030856297834*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"88cc568f-38c3-4ae2-93d2-3ffaa209ace4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "1"}], ",", "10", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.832030057106842*^9, 3.832030084847746*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"4026ae2e-0374-4f38-a128-759503062b0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Im", "[", 
       RowBox[{
        RowBox[{"w1", "*", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"w2", "*", "x"}], "+", "w3"}], "]"}], "\[Equal]", "0"}], ",", 
     
     RowBox[{
      RowBox[{"w1", "*", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"w2", "*", "x"}], "+", "w3"}], ",", 
     SuperscriptBox["10", "11"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8320302450597477`*^9, 3.832030291693736*^9}, {
  3.832032248424054*^9, 3.832032277156348*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"7b1b9ad8-4d4d-4c3b-ac71-a3da439c179b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ydata", "=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"f1", ",", "xdata"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w1", "->", "1"}], ",", 
      RowBox[{"w2", "->", "2"}], ",", 
      RowBox[{"w3", "->", "3"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydataAdjusted", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ydata", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "+", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "15"}], ",", "15"}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ydata", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8320303383067093`*^9, 3.832030338728717*^9}, {
  3.8320303721637163`*^9, 3.8320304228372583`*^9}, {3.832030619548048*^9, 
  3.832030665457159*^9}, {3.8320308324341297`*^9, 3.832030834059083*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"5a459e3e-d1f1-4178-9118-80bc91b5fe34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"combodata", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"y", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"combodata", "[", 
    RowBox[{"xdata", ",", "ydata"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{"combodata", "[", 
    RowBox[{"xdata", ",", "ydataAdjusted"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8320304511892138`*^9, 3.832030513916194*^9}, {
  3.832030770841322*^9, 3.8320307898938723`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"04fe5ca8-a9a7-45ed-b32b-b8430801e089"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", " ", "True"}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.832030522999168*^9, 3.832030529098528*^9}, {
  3.8320307962129393`*^9, 3.832030825512044*^9}, {3.83203087222799*^9, 
  3.8320308958360662`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"d7316762-59b6-432e-99bd-2e85220e1d6a"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{-1., 2.}, {0., 3.}, {1., 6.}, {2., 11.}, {3., 18.}, {4., 
       27.}, {5., 38.}, {6., 51.}, {7., 66.}, {8., 83.}, {9., 102.}, {10., 
       123.}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      LineBox[{{-1., 3.7540497928378684`}, {0., 14.150090376544007`}, {
       1., -6.990589752637632}, {2., 14.30574639842743}, {3., 
       23.76322934034777}, {4., 15.075411815807534`}, {5., 
       44.73918294655592}, {6., 37.20468706790351}, {7., 73.66277908325182}, {
       8., 82.78469297134126}, {9., 96.84860741160814}, {10., 
       135.9875646709368}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      GeometricTransformationBox[InsetBox[
        FormBox[
         StyleBox[
          GraphicsBox[
           {EdgeForm[None], DiskBox[{0, 0}]}],
          StripOnInput->False,
          GraphicsBoxOptions->{DefaultBaseStyle->Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.368417, 0.506779, 0.709798], 
            AbsoluteThickness[1.6]]}],
         TraditionalForm], {0., 0.}, Automatic, Offset[6.272]], {{{-1., 
       2.}}, {{0., 3.}}, {{1., 6.}}, {{2., 11.}}, {{3., 18.}}, {{4., 27.}}, {{
       5., 38.}}, {{6., 51.}}, {{7., 66.}}, {{8., 83.}}, {{9., 102.}}, {{10., 
       123.}}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      GeometricTransformationBox[InsetBox[
        FormBox[
         StyleBox[
          GraphicsBox[
           {EdgeForm[None], PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}],
          StripOnInput->False,
          GraphicsBoxOptions->{DefaultBaseStyle->Directive[
            PointSize[0.012833333333333334`], 
            RGBColor[0.880722, 0.611041, 0.142051], 
            AbsoluteThickness[1.6]]}],
         TraditionalForm], {0., 0.}, Automatic, Offset[6.72]], {{{-1., 
       3.7540497928378684`}}, {{0., 14.150090376544007`}}, {{
       1., -6.990589752637632}}, {{2., 14.30574639842743}}, {{3., 
       23.76322934034777}}, {{4., 15.075411815807534`}}, {{5., 
       44.73918294655592}}, {{6., 37.20468706790351}}, {{7., 
       73.66277908325182}}, {{8., 82.78469297134126}}, {{9., 
       96.84860741160814}}, {{10., 135.9875646709368}}}]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-1., 10.}, {-6.990589752637632, 135.9875646709368}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.832030530029055*^9, {3.832030793763813*^9, 3.832030825982995*^9}, {
   3.83203086542833*^9, 3.832030896219143*^9}, 3.832031634571439*^9, {
   3.832032284800544*^9, 3.832032319891368*^9}, 3.832032622636394*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"3d7a5011-ca95-4a95-98f5-63878cca9d4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"c2", ",", 
     RowBox[{"f1", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"w1", ",", "w2", ",", "w3"}], "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"params", "=", 
  RowBox[{"nlm", "[", "\"\<ParameterTable\>\"", "]"}]}]}], "Input",
 CellChangeTimes->{{3.832030924034309*^9, 3.832030924455411*^9}, {
  3.832030958357396*^9, 3.832030990687666*^9}, {3.832031141826273*^9, 
  3.832031145469453*^9}, {3.832031989223675*^9, 3.832031994122686*^9}, {
  3.832032391942865*^9, 3.832032391996428*^9}, {3.8320324990533943`*^9, 
  3.832032500906888*^9}, {3.8320325384264402`*^9, 3.8320325659564743`*^9}, {
  3.832032637251342*^9, 3.832032638372724*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"bf168772-534a-43b9-b252-69ad8dc882f9"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"w1", "1.2935826717581316`", "0.2661374087064446`", 
      "4.860581900325713`", "0.0008951113621406909`"},
     {"w2", 
      RowBox[{"-", "0.4742174591796351`"}], "2.529472382719229`", 
      RowBox[{"-", "0.18747682813988373`"}], "0.855445277940771`"},
     {"w3", "5.130856968332159`", "5.116948779207389`", "1.002718062995136`", 
      "0.3421925050817539`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{
     "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.832030991618371*^9, 3.832031634636924*^9, 3.83203199483785*^9, {
   3.832032301665416*^9, 3.832032319917925*^9}, 3.832032392263253*^9, 
   3.832032501494461*^9, {3.8320325422050962`*^9, 3.8320325718465548`*^9}, {
   3.832032622649158*^9, 3.832032639987067*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"9f621939-8e46-4cd9-a507-86faf48311b1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"unpack", "[", "pars_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"params", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "i"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "4", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pset", "=", 
   RowBox[{"unpack", "[", "params", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.832032641345172*^9, 3.832032783790886*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"408cefe6-ac13-4ad0-a79c-a010004fc22f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "[", "10", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w1", "\[Rule]", 
     RowBox[{"pset", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"w2", "\[Rule]", 
     RowBox[{"pset", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"w3", "\[Rule]", 
     RowBox[{"pset", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.832032017603339*^9, 3.832032032361801*^9}, {
  3.832032339768773*^9, 3.832032370746068*^9}, {3.832032789113092*^9, 
  3.8320328003742733`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"5469b47b-bc2d-48e9-a807-40619b4fb9f6"],

Cell[BoxData["129.74694955234895`"], "Output",
 CellChangeTimes->{
  3.8320320330105257`*^9, {3.832032304747538*^9, 3.832032371033738*^9}, 
   3.8320326226792297`*^9, 3.8320328009077063`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"79471e43-39b1-49a9-a919-11c0f9ac3f8f"]
}, Open  ]]
},
WindowSize->{1029, 832},
WindowMargins->{{Automatic, 877}, {Automatic, 175}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 221, 3, 30, "Input",ExpressionUUID->"88cc568f-38c3-4ae2-93d2-3ffaa209ace4"],
Cell[782, 25, 374, 10, 30, "Input",ExpressionUUID->"4026ae2e-0374-4f38-a128-759503062b0b"],
Cell[1159, 37, 713, 20, 33, "Input",ExpressionUUID->"7b1b9ad8-4d4d-4c3b-ac71-a3da439c179b"],
Cell[1875, 59, 1067, 29, 52, "Input",ExpressionUUID->"5a459e3e-d1f1-4178-9118-80bc91b5fe34"],
Cell[2945, 90, 957, 27, 73, "Input",ExpressionUUID->"04fe5ca8-a9a7-45ed-b32b-b8430801e089"],
Cell[CellGroupData[{
Cell[3927, 121, 630, 14, 30, "Input",ExpressionUUID->"d7316762-59b6-432e-99bd-2e85220e1d6a"],
Cell[4560, 137, 4293, 92, 245, "Output",ExpressionUUID->"3d7a5011-ca95-4a95-98f5-63878cca9d4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8890, 234, 857, 17, 52, "Input",ExpressionUUID->"bf168772-534a-43b9-b252-69ad8dc882f9"],
Cell[9750, 253, 1352, 28, 75, "Output",ExpressionUUID->"9f621939-8e46-4cd9-a507-86faf48311b1"]
}, Open  ]],
Cell[11117, 284, 659, 18, 52, "Input",ExpressionUUID->"408cefe6-ac13-4ad0-a79c-a010004fc22f"],
Cell[CellGroupData[{
Cell[11801, 306, 661, 17, 30, "Input",ExpressionUUID->"5469b47b-bc2d-48e9-a807-40619b4fb9f6"],
Cell[12465, 325, 270, 4, 34, "Output",ExpressionUUID->"79471e43-39b1-49a9-a919-11c0f9ac3f8f"]
}, Open  ]]
}
]
*)

